
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Fit robust decision trees in a matter of seconds.">
      
      
        <meta name="author" content="DaniÃ«l Vos">
      
      
        <link rel="canonical" href="https://groot.cyber-analytics.nl/reference/models/treant/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.9">
    
    
      
        <title>TREANT - GROOT</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.120efc48.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.9647289d.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#groot.treant" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="GROOT" class="md-header__button md-logo" aria-label="GROOT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GROOT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TREANT
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/tudelft-cda-lab/GROOT" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    tudelft-cda-lab/GROOT
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="GROOT" class="md-nav__button md-logo" aria-label="GROOT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    GROOT
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tudelft-cda-lab/GROOT" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    tudelft-cda-lab/GROOT
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Code Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Models" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../groot_tree/" class="md-nav__link">
        GROOT tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../groot_forest/" class="md-nav__link">
        GROOT forest
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          TREANT
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        TREANT
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#groot.treant" class="md-nav__link">
    treant
  </a>
  
    <nav class="md-nav" aria-label="treant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.Attacker" class="md-nav__link">
    Attacker
  </a>
  
    <nav class="md-nav" aria-label="Attacker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.Attacker.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Attacker.attack" class="md-nav__link">
    attack()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Attacker.attack_dataset" class="md-nav__link">
    attack_dataset()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule" class="md-nav__link">
    AttackerRule
  </a>
  
    <nav class="md-nav" aria-label="AttackerRule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.apply" class="md-nav__link">
    apply()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.get_cost" class="md-nav__link">
    get_cost()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.get_target_feature" class="md-nav__link">
    get_target_feature()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.is_applicable" class="md-nav__link">
    is_applicable()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint" class="md-nav__link">
    Constraint
  </a>
  
    <nav class="md-nav" aria-label="Constraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint.encode_for_optimizer" class="md-nav__link">
    encode_for_optimizer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint.propagate_left" class="md-nav__link">
    propagate_left()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint.propagate_right" class="md-nav__link">
    propagate_right()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Node" class="md-nav__link">
    Node
  </a>
  
    <nav class="md-nav" aria-label="Node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.Node.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Node.get_node_prediction" class="md-nav__link">
    get_node_prediction()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Node.is_leaf" class="md-nav__link">
    is_leaf()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree" class="md-nav__link">
    RobustDecisionTree
  </a>
  
    <nav class="md-nav" aria-label="RobustDecisionTree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.predict_proba" class="md-nav__link">
    predict_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.SplitOptimizer" class="md-nav__link">
    SplitOptimizer
  </a>
  
    <nav class="md-nav" aria-label="SplitOptimizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.SplitOptimizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.SplitOptimizer.evaluate_split" class="md-nav__link">
    evaluate_split()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.SplitOptimizer.optimize_gain" class="md-nav__link">
    optimize_gain()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../boosting/" class="md-nav__link">
        Provably robust boosting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../toolbox/" class="md-nav__link">
        Toolbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../adversary/" class="md-nav__link">
        Adversaries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../verification/" class="md-nav__link">
        Robustness verification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/" class="md-nav__link">
        Datasets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../visualization/" class="md-nav__link">
        Visualization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../util/" class="md-nav__link">
        Utilities
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#groot.treant" class="md-nav__link">
    treant
  </a>
  
    <nav class="md-nav" aria-label="treant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.Attacker" class="md-nav__link">
    Attacker
  </a>
  
    <nav class="md-nav" aria-label="Attacker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.Attacker.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Attacker.attack" class="md-nav__link">
    attack()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Attacker.attack_dataset" class="md-nav__link">
    attack_dataset()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule" class="md-nav__link">
    AttackerRule
  </a>
  
    <nav class="md-nav" aria-label="AttackerRule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.apply" class="md-nav__link">
    apply()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.get_cost" class="md-nav__link">
    get_cost()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.get_target_feature" class="md-nav__link">
    get_target_feature()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.AttackerRule.is_applicable" class="md-nav__link">
    is_applicable()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint" class="md-nav__link">
    Constraint
  </a>
  
    <nav class="md-nav" aria-label="Constraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint.encode_for_optimizer" class="md-nav__link">
    encode_for_optimizer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint.propagate_left" class="md-nav__link">
    propagate_left()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Constraint.propagate_right" class="md-nav__link">
    propagate_right()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Node" class="md-nav__link">
    Node
  </a>
  
    <nav class="md-nav" aria-label="Node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.Node.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Node.get_node_prediction" class="md-nav__link">
    get_node_prediction()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.Node.is_leaf" class="md-nav__link">
    is_leaf()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree" class="md-nav__link">
    RobustDecisionTree
  </a>
  
    <nav class="md-nav" aria-label="RobustDecisionTree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.predict_proba" class="md-nav__link">
    predict_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.RobustDecisionTree.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.SplitOptimizer" class="md-nav__link">
    SplitOptimizer
  </a>
  
    <nav class="md-nav" aria-label="SplitOptimizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groot.treant.SplitOptimizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.SplitOptimizer.evaluate_split" class="md-nav__link">
    evaluate_split()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groot.treant.SplitOptimizer.optimize_gain" class="md-nav__link">
    optimize_gain()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>TREANT</h1>

<div class="doc doc-object doc-module">



<h2 id="groot.treant" class="doc doc-heading">
        <code>groot.treant</code>



</h2>

    <div class="doc doc-contents first">

      <p>Created by Gabriele Tolomei on 2019-01-23.</p>
<p>Code adapted for comparison with GROOT from src/parallel_robust_forest.py
at https://github.com/gtolomei/treant</p>
<p>Also see: https://arxiv.org/abs/1907.01197</p>



  <div class="doc doc-children">












  <div class="doc doc-object doc-class">



<h3 id="groot.treant.Attacker" class="doc doc-heading">
        <code>
Attacker        </code>



</h3>

    <div class="doc doc-contents ">

      <p>Class Attacker represents an attacker.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Attacker.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">budget</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Class constructor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>rules</code></td>
        <td></td>
        <td><p>obj:<code>AttackerRule</code>): set of AttackerRule objects.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>budget</code></td>
        <td><code>float</code></td>
        <td><p>total budget of the attacker (per instance).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Attacker.attack" class="doc doc-heading">
<code class="highlight language-python"><span class="n">attack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">feature_id</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>This function retrieves the list of attacks to a given instance,
on a given feature, subject to a given cost.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Attacker.attack_dataset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">attack_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">attacks_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>This function is responsible for attacking the whole input dataset.
It either loads all the attacks from the attack file provided as input
or it computes all the attacks from scratch.</p>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="groot.treant.AttackerRule" class="doc doc-heading">
        <code>
AttackerRule        </code>



</h3>

    <div class="doc doc-contents ">

      <p>Class AttackerRule represents a rule of attack.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="groot.treant.AttackerRule.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_conditions</span><span class="p">,</span> <span class="n">post_condition</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">is_numerical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Class constructor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>pre_conditions</code></td>
        <td><code>dict</code></td>
        <td><p>set of pre-conditions which must be met in order for this rule to be applied.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>post_condition</code></td>
        <td><code>dict</code></td>
        <td><p>post-condition indicating the outcome of this rule once applied.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cost</code></td>
        <td><code>float</code></td>
        <td><p>cost of rule application.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>is_numerical</code></td>
        <td><code>boolean</code></td>
        <td><p>flag to indicate whether the attack specified by this rule operates on
                    a numerical (perturbation) or a categorical (assignment) feature.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h4 id="groot.treant.AttackerRule.apply" class="doc doc-heading">
<code class="highlight language-python"><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Application of the rule to the input instance x.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>numpy.array</code></td>
        <td><p>1-dimensional array representing an instance.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>x_prime (numpy.array)</code></td>
      <td><p>A (deep) copy of x yet modified according to the post-condition of this rule.</p></td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="groot.treant.AttackerRule.get_cost" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Return the cost of this rule.</p>

    </div>

  </div>




  <div class="doc doc-object doc-method">



<h4 id="groot.treant.AttackerRule.get_target_feature" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_target_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Return the feature (id) targeted by this rule.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="groot.treant.AttackerRule.is_applicable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_applicable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Returns whether the rule can be applied to the input instance x or not.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>numpy.array</code></td>
        <td><p>1-dimensional array representing an instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>numerical_idx</code></td>
        <td><code>list</code></td>
        <td><p>binary array which indicates whether a feature is numerical or not;
                  numerical_idx[i] = 1 iff feature id i is numerical, 0 otherwise.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>True iff this rule is applicable to x (i.e., if x satisfies ALL the pre-conditions of this rule).</p></td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="groot.treant.Constraint" class="doc doc-heading">
        <code>
Constraint        </code>



</h3>

    <div class="doc doc-contents ">

      <p>Class Constraint represents a constraint.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Constraint.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">ineq</span><span class="p">,</span> <span class="n">bound</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Class constructor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>int</code></td>
        <td><p>current instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>int/float</code></td>
        <td><p>label associated with this instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cost</code></td>
        <td><code>float</code></td>
        <td><p>cost associated with this instance (so far).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ineq</code></td>
        <td><code>int</code></td>
        <td><p>flag to encode the direction of the inequality represented by this constraint;
        0 = 'less than', 1 = 'greater than or equal to'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bound</code></td>
        <td><code>float</code></td>
        <td><p>constraint value on the loss function</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Constraint.encode_for_optimizer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">encode_for_optimizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Encode this constraint according to the format used by the optimizer.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Constraint.propagate_left" class="doc doc-heading">
<code class="highlight language-python"><span class="n">propagate_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attacker</span><span class="p">,</span> <span class="n">feature_id</span><span class="p">,</span> <span class="n">feature_value</span><span class="p">,</span> <span class="n">is_numerical</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Propagate the constraint to the left.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Constraint.propagate_right" class="doc doc-heading">
<code class="highlight language-python"><span class="n">propagate_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attacker</span><span class="p">,</span> <span class="n">feature_id</span><span class="p">,</span> <span class="n">feature_value</span><span class="p">,</span> <span class="n">is_numerical</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Propagate the constraint to the right.</p>

    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="groot.treant.Node" class="doc doc-heading">
        <code>
Node        </code>



</h3>

    <div class="doc doc-contents ">

      <p>Class Node represents a node of a decision tree.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Node.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">n_values</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">best_split_feature_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">best_split_feature_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Class constructor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>node_id</code></td>
        <td><code>int</code></td>
        <td><p>node identifier.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>values</code></td>
        <td><code>int</code></td>
        <td><p>number of instances</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>n_values</code></td>
        <td><code>int</code></td>
        <td><p>maximum number of unique y values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>left</code></td>
        <td></td>
        <td><p>obj:<code>Node</code>, optional): left child node. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>right</code></td>
        <td></td>
        <td><p>obj:<code>Node</code>, optional): left child node. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>best_split_feature_id</code></td>
        <td><code>int</code></td>
        <td><p>index of the feature associated with the best split of this Node. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>best_split_feature_value</code></td>
        <td><code>float</code></td>
        <td><p>value of the feature associated with the best split of this Node. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Node.get_node_prediction" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_node_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Get the prediction as being computed at this node.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="groot.treant.Node.is_leaf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Returns True iff the current node is a leaf (i.e., if it doesn't have neither a left nor a right child)</p>

    </div>

  </div>














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="groot.treant.RobustDecisionTree" class="doc doc-heading">
        <code>
RobustDecisionTree            (<span title="sklearn.base.BaseEstimator">BaseEstimator</span>, <span title="sklearn.base.ClassifierMixin">ClassifierMixin</span>)
        </code>



</h3>

    <div class="doc doc-contents ">

      <p>This class implements a single Robust Decision Tree.
Inspired by sklearn API, it is a sublcass of the sklearn.base.BaseEstimator class and exposes two main methods:
- fit(X, y)
- predict(X)
The former is used at training time for learning a single decision tree;
the latter is used at inference (testing) time for computing predictions using the learned tree.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="groot.treant.RobustDecisionTree.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">attacker</span><span class="o">=&lt;</span><span class="n">groot</span><span class="o">.</span><span class="n">treant</span><span class="o">.</span><span class="n">Attacker</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f5e8ea0f7f0</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">split_optimizer</span><span class="o">=&lt;</span><span class="n">groot</span><span class="o">.</span><span class="n">treant</span><span class="o">.</span><span class="n">SplitOptimizer</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f5e8ea0f850</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">min_instances_per_node</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">replace_samples</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">replace_features</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feature_blacklist</span><span class="o">=</span><span class="p">{},</span> <span class="n">affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Class constructor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>tree_id</code></td>
        <td><code>int</code></td>
        <td><p>tree identifier.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>attacker</code></td>
        <td></td>
        <td><p>obj:<code>Attacker</code>): the attacker under which this tree must grow (default = empty attacker).</p></td>
        <td><code>&lt;groot.treant.Attacker object at 0x7f5e8ea0f7f0&gt;</code></td>
      </tr>
      <tr>
        <td><code>split_optimizer</code></td>
        <td></td>
        <td><p>obj:<code>SplitOptimizer</code>): the optimizer used by this tree (default = SSE).</p></td>
        <td><code>&lt;groot.treant.SplitOptimizer object at 0x7f5e8ea0f850&gt;</code></td>
      </tr>
      <tr>
        <td><code>max_depth</code></td>
        <td><code>int</code></td>
        <td><p>maximum depth of the tree to be generated (default = 10).</p></td>
        <td><code>8</code></td>
      </tr>
      <tr>
        <td><code>min_instances_per_node</code></td>
        <td><code>int</code></td>
        <td><p>minimum number of instances per node (default = 20).</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>max_samples</code></td>
        <td><code>float</code></td>
        <td><p>proportion of instances sampled without replacement (default = 1.0, i.e., 100%)</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>max_features</code></td>
        <td><code>float</code></td>
        <td><p>proportion of features sampled without replacement (default = 1.0, i.e., 100%)</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>feature_blacklist</code></td>
        <td><code>dict</code></td>
        <td><p>dictionary of features excluded during tree growth (default = {}), i.e., empty).</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>replace_samples</code></td>
        <td><code>bool</code></td>
        <td><p>whether the random sampling of instances should be with replacement or not (default = False).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>replace_features</code></td>
        <td><code>bool</code></td>
        <td><p>whether the random sampling of features should be with replacement or not (default = False).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>seed</code></td>
        <td><code>int</code></td>
        <td><p>integer used by randomized processes.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="groot.treant.RobustDecisionTree.fit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numerical_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>This function is the public API's entry point for client code to start training a single Robust Decision Tree.
It saves both the input data (X) and labels/targets (y) in the internals of the tree and delegates off to
the private self.__fit method. The result being a reference to the root node of the trained tree.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>X</code></td>
        <td><code>numpy.array</code></td>
        <td><p>2-dimensional array of shape (n_samples, n_features)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>numpy.array</code></td>
        <td><p>1-dimensional array of values of shape (n_samples, )</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h4 id="groot.treant.RobustDecisionTree.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>This function is the public API's entry point for client code to obtain predictions from an already trained tree.
If this tree hasn't been trained yet, predictions cannot be made; otherwise, for each instance in X, the tree is traversed
until a leaf node is met: the prediction stored at that leaf node is the one returned to the caller.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>X</code></td>
        <td><code>numpy.array</code></td>
        <td><p>2-dimensional array of shape (n_test_samples, n_features) containing
             samples which we want to know the predictions of.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>predictions (numpy.array)</code></td>
      <td><p>1-dimensional array of shape (n_test_samples, ).</p></td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="groot.treant.RobustDecisionTree.predict_proba" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>This function is the public API's entry point for client code to obtain predictions from an already trained tree.
If this tree hasn't been trained yet, predictions cannot be made; otherwise, for each instance in X, the tree is traversed
until a leaf node is met: the prediction stored at that leaf node is the one returned to the caller.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>X</code></td>
        <td><code>numpy.array</code></td>
        <td><p>2-dimensional array of shape (n_test_samples, n_features) containing
             samples which we want to know the predictions of.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>probs (numpy.array)</code></td>
      <td><p>2-dimensional array of shape (n_test_samples, 2) containing probability scores both for class 0 (1st column) and class 1 (2nd column).</p></td>
    </tr>
  </tbody>
</table>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h4 id="groot.treant.RobustDecisionTree.save" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>This function is used to persist this RobustDecisionTree object to file on disk using dill.</p>

    </div>

  </div>









  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="groot.treant.SplitOptimizer" class="doc doc-heading">
        <code>
SplitOptimizer        </code>



</h3>

    <div class="doc doc-contents ">

      <p>Class used for determining the best splitting strategy, accoriding to a specific splitting function.
The class comes with few splitting functions already implemented. In particular, those are as follows:</p>
<ul>
<li>__gini_impurity (classification);</li>
<li>__entropy (classification);</li>
<li>__logloss (classificattion);</li>
<li>__mse (regression);</li>
<li>__sse (regression);</li>
<li>__mae (regression).</li>
</ul>
<p>Of course this class can be instantiated with custom, user-defined splitting functions.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="groot.treant.SplitOptimizer.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">split_function_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">icml2019</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Class constructor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>split_function</code></td>
        <td><code>func</code></td>
        <td><p>The function used as splitting criterion.
                     Defaults to None, if so it falls back to __gini_impurity implemented internally.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>      <p>if split_function is None:
    self.split_function = SplitOptimizer._SplitOptimizer__sse
    self.split_function_name = "SSE"</p>
<p>!!! else
    self.split_function = split_function
    if split_function_name is None:
        split_function_name = split_function.<strong>name</strong>
    self.split_function_name = split_function_name</p>

    </div>

  </div>




  <div class="doc doc-object doc-method">



<h4 id="groot.treant.SplitOptimizer.evaluate_split" class="doc doc-heading">
<code class="highlight language-python"><span class="n">evaluate_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>This function is a meta-function which calls off to the actual splitting function along with input arguments.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="groot.treant.SplitOptimizer.optimize_gain" class="doc doc-heading">
<code class="highlight language-python"><span class="n">optimize_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">numerical_idx</span><span class="p">,</span> <span class="n">feature_blacklist</span><span class="p">,</span> <span class="n">n_sample_features</span><span class="p">,</span> <span class="n">replace_features</span><span class="p">,</span> <span class="n">attacker</span><span class="p">,</span> <span class="n">costs</span><span class="p">,</span> <span class="n">constraints</span><span class="p">,</span> <span class="n">current_score</span><span class="p">,</span> <span class="n">current_prediction_score</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>This function is responsible for finding the splitting which optimizes the gain (according to the splitting function)
among all the possibile splittings.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>X</code></td>
        <td><code>numpy.array</code></td>
        <td><p>2-dimensional array of shape (n_samples, n_features) representing the feature matrix;</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>numpy.array</code></td>
        <td><p>1-dimensional array of shape (n_samples, ) representing class labels (classification) or target values (regression).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>rows</code></td>
        <td><code>numpy.array</code></td>
        <td><p>1-dimensional array containing the indices of a subset of n_samples (i.e., a subset of the rows of X and y).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>numerical_idx</code></td>
        <td><code>list</code></td>
        <td><p>binary array which indicates whether a feature is numerical or not;
                  numerical_idx[i] = 1 iff feature id i is numerical, 0 otherwise.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>feature_blacklist</code></td>
        <td><code>set</code></td>
        <td><p>set of (integer) indices corresponding to blacklisted features.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>n_sample_features</code></td>
        <td><code>int</code></td>
        <td><p>number of features to be randomly sampled at each node split.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>attacker</code></td>
        <td></td>
        <td><p>obj:<code>Attacker</code>): attacker.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>costs</code></td>
        <td><code>dict</code></td>
        <td><p>cost associated with each instance (indexed by rows).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>constraints</code></td>
        <td><code>list</code></td>
        <td><p>list of <code>Constraint</code> objects.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>current_score</code></td>
        <td><code>float</code></td>
        <td><p>is the score before any splitting is done; this must be compared with the best splitting found.
                     Whenever the current_score is greater than the one computed after splitting there will be a gain.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>best_gain (float)</code></td>
      <td><p>The highest gain obtained after all the possible splittings have been tested
                     (may be 0, in which case the splitting will be not worth it)
best_split_left_id (numpy.array): 1-dimensional array containing all the indices of rows going on the left branch.
best_split_right_id (numpy.array): 1-dimensional array containing all the indices of rows going on the right branch.
best_split_feature_id (int): index of the feature which led to the best splitting.
best_split_feature_value (int/float): value of the feature which led to the best splitting.
next_best_split_feature_value (int/float): next-observed value of the feature which led to the best splitting.
constraints_left (numpy.array): array of constraints if propagated to left.
constraints_right (numpy.array): array of constraints if propagated to right.
costs_left (numpy.array): array of costs if propagated left.
costs_right (numpy.array): array of cost if propagated right.</p></td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>










  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../groot_forest/" class="md-footer__link md-footer__link--prev" aria-label="Previous: GROOT forest" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              GROOT forest
            </div>
          </div>
        </a>
      
      
        
        <a href="../boosting/" class="md-footer__link md-footer__link--next" aria-label="Next: Provably robust boosting" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Provably robust boosting
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 DaniÃ«l Vos
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections"], "search": "../../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.6e54b5cd.min.js"></script>
      
    
  </body>
</html>